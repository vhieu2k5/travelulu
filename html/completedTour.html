<!DOCTYPE html>
<html lang="vi">

<head>
  <title>Travelulu - Chi tiết Tour</title>
  <meta content="charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css?family=League Spartan" rel="stylesheet" />

  <link rel="stylesheet" href="../css/tourdetail.css" />
  <link rel="stylesheet" href="../css/ManagementTour.css" />
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

  <script src="../js/header.js" defer></script>
</head>

<body>
  <div data-include="../html/header.html"></div>

  <div class="container-detail tour-detail-container">
    <div class="title-tour-detail">
      <a href="../html/ManagementTour.html" class="back-link">&leftarrow;</a>
      <h2>Tour Hà Giang 4N3Đ - khởi hành từ Đà Nẵng</h2>
    </div>

    <main class="main-content-grid">
      <div class="left-column">
        <section class="booking-summary-section">
          <div class="booking-tabs">
            <div class="tab active">Mã đặt chỗ</div>
          </div>
          <div class="booking-details">
            <div class="detail-block">
              <span class="label">273699</span>
            </div>
            <div class="detail-block full-width">
              <p class="tour-title-small">
                Tour Hà Giang 4N3Đ - khởi hành từ Đà Nẵng
              </p>
              <p class="tour-id">ID tour: D43HG2025</p>
            </div>
            <div class="detail-block">
              <span class="label">Ngày đi</span>
              <span class="value">T3, 9 tháng 9</span>
            </div>
            <div class="detail-block">
              <span class="label">Ngày về</span>
              <span class="value">T6, 12 tháng 9</span>
            </div>
            <div class="tour-image"></div>
          </div>
        </section>

        <section class="itinerary-section">
          <h2 class="section-title">Lịch trình cụ thể</h2>
          <div class="itinerary-content" style="padding: 15px">
            <div class="day-itinerary">
              <h3 class="day-title">
                Ngày 1: Hà Nội - Ninh Bình - Khám phá Tràng An
              </h3>
              <div class="itinerary-meal">
                <span class="meal-label">Sáng:</span>
                <ul>
                  <li>07:00: Xuất phát từ PTIT Hà Nội.</li>
                  <li>09:00: Đến Tràng An, nhận phòng khách sạn / resort.</li>
                  <li>09:30: Di chuyển tham quan quần thể Tràng An.</li>
                </ul>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Trưa:</span>
                <p>
                  12:00: Ăn trưa tại nhà hàng địa phương (đặc sản dê núi, cơm
                  cháy).
                </p>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Chiều:</span>
                <ul>
                  <li>
                    Tham quan đền Trình - Phủ Khống (nằm trong quần thể Tràng
                    An).
                  </li>
                  <li>
                    Trở về khách sạn nghỉ ngơi, tận hưởng bể bơi hoặc spa.
                  </li>
                </ul>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Tối:</span>
                <ul>
                  <li>Ăn tối tại khách sạn hoặc quán đặc sản.</li>
                  <li>
                    Dạo phố Ninh Bình, thưởng thức chè bưởi, nem chua Yên
                    Mộc...
                  </li>
                </ul>
              </div>
            </div>

            <div class="day-itinerary">
              <h3 class="day-title">
                Ngày 2: Tam Cốc - Bích Động - Hang Múa
              </h3>
              <div class="itinerary-meal">
                <span class="meal-label">Sáng:</span>
                <ul>
                  <li>
                    Tham quan Tam Cốc (đi thuyền ngắm cảnh, còn gọi là "Vịnh
                    Hạ Long trên cạn").
                  </li>
                  <li>Chụp ảnh tại chùa Bích Động.</li>
                </ul>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Trưa:</span>
                <p>12:00: Ăn trưa tại nhà hàng ven sông đã được đặt trước.</p>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Chiều:</span>
                <ul>
                  <li>
                    Leo núi Hang Múa, ngắm toàn cảnh Tam Cốc từ trên cao.
                  </li>
                  <li>Về khách sạn nghỉ ngơi.</li>
                </ul>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Tối:</span>
                <ul>
                  <li>Ăn tối tại nhà hàng.</li>
                  <li>
                    Tham gia đốt lửa trại (nếu theo đoàn đông) hoặc tự do khám
                    phá quán cà phê view núi.
                  </li>
                </ul>
              </div>
            </div>

            <div class="day-itinerary">
              <h3 class="day-title">Ngày 3: Cố đô Hoa Lư - Trở về Hà Nội</h3>
              <div class="itinerary-meal">
                <span class="meal-label">Sáng:</span>
                <ul>
                  <li>Tham quan đền Đinh - đền Lê (khu di tích Hoa Lư).</li>
                  <li>
                    Mua đặc sản (cơm cháy, rượu Kim Sơn, mắm tép Gia Viễn).
                  </li>
                </ul>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Trưa:</span>
                <p>Ăn trưa nhẹ tại nhà hàng.</p>
              </div>
              <div class="itinerary-meal">
                <span class="meal-label">Chiều:</span>
                <ul>
                  <li>Trả phòng khách sạn, di chuyển về Hà Nội.</li>
                  <li>17:00: Về đến PTIT, kết thúc tour.</li>
                </ul>
              </div>
            </div>
          </div>
        </section>
      </div>
      <div class="right-column">
        <section class="pickup-location-section card">
          <h2 class="section-title-right pickup-title">Địa điểm xe đón</h2>
          <div class="map-frame">
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d783.1455723109073!2d105.78728163918139!3d20.98104351184216!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3135accdd8a1ad71%3A0xa2f9b16036648187!2zSOG7jWMgdmnhu4duIEPDtG5nIG5naOG7hyBCxrB1IGNow61uaCB2aeG7hW4gdGjDtG5n!5e0!3m2!1svi!2s!4v1761719934603!5m2!1svi!2s"
              allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </section>

        <section class="guide-info-section card">
          <h2 class="section-title-right">Thông tin hướng dẫn viên</h2>
          <div class="guide-details">
            <div>
              <p>
                <i class="fa-solid fa-user-circle"></i> Họ và tên: Võ Minh Hụ
              </p>
              <p><i class="fa-solid fa-phone"></i> Liên hệ: 0911309301</p>
            </div>
          </div>
        </section>

        <section class="note-section card">
          <h2 class="section-title-right">Viết đánh giá</h2>
          <textarea class="note-area"></textarea>
          <i style="margin-top: 10px; display: block; text-align: center;">Bạn đánh giá chuyến đi như nào?</i>
          <div class="rate-stars">
            <i class="fa-regular fa-star"></i>
            <i class="fa-regular fa-star"></i>
            <i class="fa-regular fa-star"></i>
            <i class="fa-regular fa-star"></i>
            <i class="fa-regular fa-star"></i>
          </div>

          <button class="action-button primary">Gửi đánh giá</button>
      
        </section>
      </div>
    </main>
    <div style="width: 100%; display: flex; align-items: center; margin: 20px; justify-content: center;">
      <img src="../pics/Mascot/bombastic sideeyes.png" alt="" srcset="" style="width: 5%; margin-right: 20px;">
<a href="checkout.html" class="action-button primary" style="margin: 20px 0; width: 60%; padding: 20px; border-radius: 10px; font-size: 20px;" >Đặt Lại Chuyến Đi</a>
  </div>
   <div class="support-footer">
      <div class="support-content">
        <span class="support-icon"> </span>
        <div class="support-text">
          <h3>Cần giúp đỡ?</h3>
          <p>
            Nếu gặp khó khăn trong việc đặt tour hay có thắc mắc về tour của
            mình, đừng ngần ngại liên hệ với chúng tôi để có thể đảm bảo thông
            tin của mình.
          </p>
        </div>
      </div>
      <button class="action-button secondary">
        Liên hệ chăm sóc khách hàng
      </button>
    </div>
  </div>
  <div class="container">
    <h2 class="recommendation-title">Một số tour bạn có thể thích</h2>

    <section class="recommendation-list"></section>
  </div>
  <div class="footer">
    <div class="footer footer-mask"></div>
    <div>
      <div>
        <b>Đối tác thanh toán</b>
        <div class="bank-group">
          <img src="../pics/debitCard.png" alt="" />
          <img src="../pics/visaCard.png" alt="" />
          <img src="../pics/jcbCard.png" alt="" />
          <img src="../pics/VIBCard.png" alt="" />
          <img src="../pics/BIDVCard.png" alt="" />
          <img src="../pics/TPBankCard.png" alt="" />
        </div>
      </div>
      <div>
        <b>Liên hệ với chúng tôi</b>
        <div>
          <p><b>HotLine</b>: 0986 868 686</p>
          <p><b>Email</b>: TheTeamProduction@gamil.com</p>
          <p><b>Facebook</b>: The Team Production</p>
          <p><b>Địa chỉ</b>: Km 10 Nguyễn Trãi Hà Đông, Hà Nội</p>
        </div>
      </div>
    </div>
    <div style="width: 1000px; height: 2px; background: white; margin: 10px 0"></div>
    <p>
      Travelulu là nền tảng du lịch trực tuyến, đồng hành cùng bạn trên mọi
      hành trình khám phá vẻ đẹp Việt Nam.
    </p>
    <p>Bản quyền © 2025 Travelulu. Bảo lưu mọi quyền.</p>
    <div class="bank-group">
      <img src="../pics/vietnamAirLine.png" alt="" />
      <img src="../pics/vietjet.png" alt="" />
      <img src="../pics/bambooAirLine.png" alt="" />
    </div>
  </div>

  <script>
    // Setup cancel confirmation modal for tour detail page
    (function () {
      function qs(sel) {
        return document.querySelector(sel);
      }

      function parseBookingId() {
        try {
          const params = new URLSearchParams(window.location.search);
          return params.get("bookingId");
        } catch (e) {
          return null;
        }
      }

      const bookingId = parseBookingId();
      const cancelBtn = qs(".refund-policy-section .action-button.primary");
      if (!cancelBtn) return;

      cancelBtn.addEventListener("click", function (e) {
        e.preventDefault();
        // create overlay
        const overlay = document.createElement("div");
        overlay.className = "modal-overlay";

        const dialog = document.createElement("div");
        dialog.className = "confirm-dialog";
        dialog.innerHTML = `
            <div class="confirm-title">Bạn có chắc chắn muốn hủy tour này không?</div>
            <div class="confirm-body">Ưu đãi và giá cả có thể thay đổi liên tục nên ưu đãi này có thể sẽ không còn nếu quý khách hủy ngay bây giờ. Quý khách có chắc chắn muốn hủy không?</div>
            <div class="confirm-actions">
              <button class="btn-cancel-dialog">Quay lại</button>
              <button class="btn-confirm-dialog">Hủy Tour</button>
            </div>
          `;

        overlay.appendChild(dialog);
        document.body.appendChild(overlay);

        // close helper
        function close() {
          if (overlay && overlay.parentNode)
            overlay.parentNode.removeChild(overlay);
        }

        // ESC to close
        function onKey(e) {
          if (e.key === "Escape") {
            close();
            document.removeEventListener("keydown", onKey);
          }
        }

        document.addEventListener("keydown", onKey);

        const btnCancel = dialog.querySelector(".btn-cancel-dialog");
        const btnConfirm = dialog.querySelector(".btn-confirm-dialog");

        btnCancel.addEventListener("click", function () {
          close();
          document.removeEventListener("keydown", onKey);
        });

        btnConfirm.addEventListener("click", function () {
          // Call fake API if available
          if (
            window.TourAPI &&
            typeof window.TourAPI.cancelBooking === "function" &&
            bookingId
          ) {
            const ok = window.TourAPI.cancelBooking(bookingId);
            // Update UI: switch the detail page button to 'Đặt lại' so user can rebook (show info)
            if (ok) {
              // mark confirm button as completed
              btnConfirm.textContent = "Đã hủy";
              btnConfirm.disabled = true;

              // Replace the original cancel button with a 'Đặt lại' action
              const newBtn = cancelBtn.cloneNode(true);
              newBtn.textContent = "Đặt lại";
              // ensure it's enabled for user to click
              newBtn.disabled = false;
              // swap in DOM
              cancelBtn.parentNode.replaceChild(newBtn, cancelBtn);

              // Attach 'Đặt lại' behavior: show info dialog (cannot rebook)
              newBtn.addEventListener("click", function (ev) {
                ev.preventDefault();
                ev.stopPropagation();
                const ov = document.createElement("div");
                ov.className = "modal-overlay";
                const info = document.createElement("div");
                info.className = "info-dialog";
                info.innerHTML = `
                    <div style="text-align:center; padding:18px 22px;">
                      <div class="warning-icon" aria-hidden="true">
                        <img src="../pics/manegamentTour/canhbao.png" alt="cảnh báo" />
                      </div>
                      <div class="info-text" style="margin-top:8px; color:#1f2937; font-weight:700;">Tour không còn khả dụng để đặt lại</div>
                      <div style="margin-top:14px; text-align:right;"><button class="btn-close-info">Quay lại</button></div>
                    </div>
                  `;
                ov.appendChild(info);
                document.body.appendChild(ov);
                const btnClose = info.querySelector(".btn-close-info");
                btnClose.addEventListener("click", function () {
                  if (ov && ov.parentNode) ov.parentNode.removeChild(ov);
                });
              });
            } else {
              btnConfirm.textContent = "Thất bại";
            }
          }
          // close after a short delay so user sees change
          setTimeout(() => {
            close();
            document.removeEventListener("keydown", onKey);
          }, 700);
        });
      });
    })();
  </script>
  <script src="../jvs/managementTour.js"></script>
</body>

</html>